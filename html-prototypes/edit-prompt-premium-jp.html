<!DOCTYPE html>
<html lang="ja" class="h-full">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PromptStocks - プロンプト編集</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'craft-teal': '#1DB584',
                        'craft-teal-light': '#20D394',
                        'craft-teal-dark': '#1A9D75',
                        'craft-gray': '#F8F9FA',
                        'craft-gray-dark': '#343A40',
                        'prompt-purple': '#8B5CF6',
                        'prompt-blue': '#3B82F6',
                        'prompt-pink': '#EC4899',
                        'prompt-orange': '#F59E0B',
                        'craft-black': '#212529',
                        'glass': 'rgba(255, 255, 255, 0.85)',
                        'glass-dark': 'rgba(0, 0, 0, 0.05)'
                    },
                    fontFamily: {
                        'sf': ['-apple-system', 'BlinkMacSystemFont', 'SF Pro Display', 'Segoe UI', 'Roboto', 'sans-serif'],
                        'mono': ['SF Mono', 'Monaco', 'Inconsolata', 'Roboto Mono', 'monospace']
                    },
                    borderRadius: {
                        'xl': '1rem',
                        '2xl': '1.25rem',
                        '3xl': '1.5rem',
                        '4xl': '2rem'
                    },
                    animation: {
                        'slide-up': 'slideUp 0.6s cubic-bezier(0.16, 1, 0.3, 1)',
                        'slide-in': 'slideIn 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94)',
                        'fade-in': 'fadeIn 0.4s ease-out',
                        'scale-in': 'scaleIn 0.3s cubic-bezier(0.16, 1, 0.3, 1)',
                        'pulse-glow': 'pulseGlow 2s ease-in-out infinite',
                        'bounce-soft': 'bounceSoft 1s ease-in-out infinite'
                    },
                    keyframes: {
                        slideUp: {
                            'from': { transform: 'translateY(20px)', opacity: '0' },
                            'to': { transform: 'translateY(0)', opacity: '1' }
                        },
                        slideIn: {
                            'from': { transform: 'translateX(-20px)', opacity: '0' },
                            'to': { transform: 'translateX(0)', opacity: '1' }
                        },
                        fadeIn: {
                            'from': { opacity: '0' },
                            'to': { opacity: '1' }
                        },
                        scaleIn: {
                            'from': { transform: 'scale(0.95)', opacity: '0' },
                            'to': { transform: 'scale(1)', opacity: '1' }
                        },
                        pulseGlow: {
                            '0%, 100%': { boxShadow: '0 0 20px rgba(29, 181, 132, 0.3)' },
                            '50%': { boxShadow: '0 0 30px rgba(29, 181, 132, 0.6)' }
                        },
                        bounceSoft: {
                            '0%, 100%': { transform: 'scale(1)' },
                            '50%': { transform: 'scale(1.05)' }
                        }
                    },
                    boxShadow: {
                        'craft': '0 1px 3px rgba(0, 0, 0, 0.1), 0 1px 2px rgba(0, 0, 0, 0.06)',
                        'craft-lg': '0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)',
                        'craft-xl': '0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)',
                        'teal-glow': '0 0 30px rgba(29, 181, 132, 0.3)',
                        'inner-light': 'inset 0 2px 4px 0 rgba(255, 255, 255, 0.15)'
                    }
                }
            }
        }
    </script>
    <style>
        .glass-morphism {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
        }
        
        .glass-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(30px);
            -webkit-backdrop-filter: blur(30px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .gradient-teal {
            background: linear-gradient(135deg, #1DB584 0%, #20D394 100%);
        }
        
        .text-gradient {
            background: linear-gradient(135deg, #1DB584 0%, #8B5CF6 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .hover-lift {
            transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        
        .hover-lift:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
        }
        
        .form-input {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        
        .form-input:focus {
            background: rgba(255, 255, 255, 1);
            border-color: #1DB584;
            box-shadow: 0 0 0 3px rgba(29, 181, 132, 0.1), 0 4px 12px rgba(29, 181, 132, 0.15);
        }
        
        .tag-button {
            background: linear-gradient(145deg, rgba(255, 255, 255, 0.9), rgba(255, 255, 255, 0.7));
            backdrop-filter: blur(15px);
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        
        .tag-button.selected {
            background: linear-gradient(135deg, #1DB584, #20D394);
            color: white;
            box-shadow: 0 4px 15px rgba(29, 181, 132, 0.3);
        }
        
        .modal-backdrop {
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }
        
        .save-animation {
            animation: saveSuccess 0.6s ease-out;
        }
        
        @keyframes saveSuccess {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .word-count {
            transition: color 0.3s ease;
        }
        
        .word-count.warning {
            color: #F59E0B;
        }
        
        .word-count.danger {
            color: #EF4444;
        }
        
        .auto-resize {
            min-height: 200px;
            resize: none;
        }
        
        .progress-ring {
            transform: rotate(-90deg);
        }
        
        .progress-ring-circle {
            stroke-dasharray: 251.2;
            stroke-dashoffset: 251.2;
            transition: stroke-dashoffset 0.5s ease-in-out;
        }
    </style>
</head>
<body class="bg-craft-gray font-sf min-h-screen">
    <!-- Main Container -->
    <div class="max-w-sm mx-auto bg-white min-h-screen relative overflow-hidden">
        
        <!-- Status Bar -->
        <div class="flex items-center justify-between px-6 pt-3 pb-1 text-craft-black">
            <div class="font-medium text-lg">9:41</div>
            <div class="flex items-center space-x-1">
                <div class="flex space-x-1">
                    <div class="w-1 h-3 bg-craft-black rounded-full"></div>
                    <div class="w-1 h-3 bg-craft-black rounded-full"></div>
                    <div class="w-1 h-3 bg-craft-black rounded-full"></div>
                    <div class="w-1 h-3 bg-gray-300 rounded-full"></div>
                </div>
                <svg class="w-5 h-5 ml-1" fill="currentColor" viewBox="0 0 20 20">
                    <path d="M2 11a1 1 0 011-1h2a1 1 0 011 1v5a1 1 0 01-1 1H3a1 1 0 01-1-1v-5zM8 7a1 1 0 011-1h2a1 1 0 011 1v9a1 1 0 01-1 1H9a1 1 0 01-1-1V7zM14 4a1 1 0 011-1h2a1 1 0 011 1v12a1 1 0 01-1 1h-2a1 1 0 01-1-1V4z"></path>
                </svg>
                <div class="w-6 h-3 border border-craft-black rounded-sm">
                    <div class="w-4 h-2 bg-craft-teal rounded-sm m-0.5"></div>
                </div>
            </div>
        </div>

        <!-- Header -->
        <header class="px-6 py-4 animate-slide-in">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-3">
                    <button id="back-btn" class="w-10 h-10 glass-morphism rounded-xl flex items-center justify-center hover-lift">
                        <svg class="w-5 h-5 text-craft-black" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                        </svg>
                    </button>
                    <div>
                        <h1 class="text-xl font-bold text-craft-black">プロンプト編集</h1>
                        <p class="text-sm text-gray-500">AI効率化プロンプト</p>
                    </div>
                </div>
                <button id="save-btn" class="gradient-teal text-white px-4 py-2 rounded-xl text-sm font-medium shadow-teal-glow hover:scale-105 transition-transform duration-200">
                    保存
                </button>
            </div>
        </header>

        <!-- Form Content -->
        <div class="px-6 pb-32 space-y-6">
            
            <!-- Title Input -->
            <div class="animate-fade-in" style="animation-delay: 0.1s;">
                <label class="block text-sm font-semibold text-craft-black mb-3">
                    タイトル <span class="text-red-500">*</span>
                </label>
                <input 
                    id="title-input"
                    type="text" 
                    value="会議議事録を効率的に作成する"
                    class="w-full px-4 py-4 form-input rounded-2xl text-craft-black placeholder-gray-400 focus:outline-none transition-all duration-300" 
                    placeholder="プロンプトのタイトルを入力"
                    required
                >
            </div>

            <!-- Category Selection -->
            <div class="animate-fade-in" style="animation-delay: 0.2s;">
                <label class="block text-sm font-semibold text-craft-black mb-3">カテゴリ</label>
                <div class="relative">
                    <select class="w-full px-4 py-4 form-input rounded-2xl text-craft-black bg-white focus:outline-none appearance-none cursor-pointer">
                        <option value="efficiency">🎯 作業効率</option>
                        <option value="writing">✍️ 文章作成</option>
                        <option value="analysis">📊 データ分析</option>
                        <option value="communication">💬 コミュニケーション</option>
                        <option value="other">📁 その他</option>
                    </select>
                    <div class="absolute inset-y-0 right-0 pr-4 flex items-center pointer-events-none">
                        <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                        </svg>
                    </div>
                </div>
            </div>

            <!-- Content Input -->
            <div class="animate-fade-in" style="animation-delay: 0.3s;">
                <div class="flex items-center justify-between mb-3">
                    <label class="block text-sm font-semibold text-craft-black">
                        プロンプト内容 <span class="text-red-500">*</span>
                    </label>
                    <div class="flex items-center space-x-2">
                        <div class="w-8 h-8 relative">
                            <svg class="progress-ring w-8 h-8">
                                <circle 
                                    class="progress-ring-circle stroke-craft-teal" 
                                    stroke-width="2" 
                                    fill="transparent" 
                                    r="12" 
                                    cx="16" 
                                    cy="16"
                                    id="progress-circle"
                                />
                            </svg>
                            <div class="absolute inset-0 flex items-center justify-center">
                                <span class="text-xs font-medium text-craft-teal" id="progress-text">85%</span>
                            </div>
                        </div>
                        <span id="word-count" class="text-sm font-medium text-gray-500">247 / 2000</span>
                    </div>
                </div>
                <div class="glass-card rounded-3xl p-6 shadow-craft-lg">
                    <textarea 
                        id="content-textarea"
                        class="w-full auto-resize bg-transparent text-craft-black placeholder-gray-400 focus:outline-none resize-none leading-relaxed" 
                        placeholder="あなたのプロンプトを入力してください..."
                        required
                    >あなたは経験豊富な会議ファシリテーターです。以下の会議の録音内容を基に、構造化された議事録を作成してください。

## 作成する議事録に含める要素：
1. **会議基本情報**（日時、参加者、議題）
2. **主要な議論ポイント**（決定事項、課題、意見）
3. **アクションアイテム**（担当者、期限、優先度）
4. **次回までの宿題**
5. **その他の重要な情報**

## 出力形式：
- 簡潔で読みやすい箇条書き
- 重要度に応じた優先順位付け
- 期限付きタスクの明確化</textarea>
                </div>
            </div>

            <!-- Tags Section -->
            <div class="animate-fade-in" style="animation-delay: 0.4s;">
                <label class="block text-sm font-semibold text-craft-black mb-3">タグ</label>
                <div class="glass-card rounded-3xl p-6 shadow-craft-lg">
                    <div class="flex flex-wrap gap-2 mb-4">
                        <button class="tag-button selected px-3 py-2 rounded-xl text-sm font-medium">効率化</button>
                        <button class="tag-button px-3 py-2 rounded-xl text-sm font-medium">会議</button>
                        <button class="tag-button px-3 py-2 rounded-xl text-sm font-medium">議事録</button>
                        <button class="tag-button px-3 py-2 rounded-xl text-sm font-medium">ビジネス</button>
                        <button class="tag-button px-3 py-2 rounded-xl text-sm font-medium">構造化</button>
                    </div>
                    <div class="flex items-center space-x-2">
                        <input 
                            id="new-tag-input"
                            type="text" 
                            placeholder="新しいタグを追加..."
                            class="flex-1 px-3 py-2 bg-white/80 rounded-xl text-sm text-craft-black placeholder-gray-400 focus:outline-none focus:bg-white border border-gray-200 focus:border-craft-teal transition-all duration-300"
                        >
                        <button id="add-tag-btn" class="gradient-teal text-white px-3 py-2 rounded-xl text-sm font-medium hover:scale-105 transition-transform duration-200">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                            </svg>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Settings -->
            <div class="animate-fade-in" style="animation-delay: 0.5s;">
                <label class="block text-sm font-semibold text-craft-black mb-3">設定</label>
                <div class="glass-card rounded-3xl p-6 shadow-craft-lg space-y-4">
                    
                    <!-- Favorite Toggle -->
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-3">
                            <div class="w-8 h-8 bg-prompt-pink/10 rounded-lg flex items-center justify-center">
                                <svg class="w-4 h-4 text-prompt-pink" fill="currentColor" viewBox="0 0 20 20">
                                    <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path>
                                </svg>
                            </div>
                            <div>
                                <h4 class="font-medium text-craft-black">お気に入り</h4>
                                <p class="text-xs text-gray-500">クイックアクセスに追加</p>
                            </div>
                        </div>
                        <div class="relative">
                            <input type="checkbox" id="favorite-toggle" class="sr-only" checked>
                            <label for="favorite-toggle" class="flex items-center cursor-pointer">
                                <div class="relative">
                                    <div class="w-12 h-6 bg-gray-300 rounded-full shadow-inner transition-colors duration-300"></div>
                                    <div class="absolute inset-y-0 left-0 w-6 h-6 bg-white rounded-full shadow transform transition-transform duration-300 translate-x-6 gradient-teal"></div>
                                </div>
                            </label>
                        </div>
                    </div>

                    <!-- Template Toggle -->
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-3">
                            <div class="w-8 h-8 bg-prompt-purple/10 rounded-lg flex items-center justify-center">
                                <svg class="w-4 h-4 text-prompt-purple" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 5a1 1 0 011-1h14a1 1 0 011 1v2a1 1 0 01-1 1H5a1 1 0 01-1-1V5zM4 13a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H5a1 1 0 01-1-1v-6zM16 13a1 1 0 011-1h2a1 1 0 011 1v6a1 1 0 01-1 1h-2a1 1 0 01-1-1v-6z"></path>
                                </svg>
                            </div>
                            <div>
                                <h4 class="font-medium text-craft-black">テンプレート化</h4>
                                <p class="text-xs text-gray-500">再利用可能なテンプレートとして保存</p>
                            </div>
                        </div>
                        <div class="relative">
                            <input type="checkbox" id="template-toggle" class="sr-only">
                            <label for="template-toggle" class="flex items-center cursor-pointer">
                                <div class="relative">
                                    <div class="w-12 h-6 bg-gray-300 rounded-full shadow-inner transition-colors duration-300"></div>
                                    <div class="absolute inset-y-0 left-0 w-6 h-6 bg-white rounded-full shadow transform transition-transform duration-300"></div>
                                </div>
                            </label>
                        </div>
                    </div>

                    <!-- Privacy Toggle -->
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-3">
                            <div class="w-8 h-8 bg-prompt-orange/10 rounded-lg flex items-center justify-center">
                                <svg class="w-4 h-4 text-prompt-orange" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path>
                                </svg>
                            </div>
                            <div>
                                <h4 class="font-medium text-craft-black">プライベート</h4>
                                <p class="text-xs text-gray-500">ローカル端末のみに保存</p>
                            </div>
                        </div>
                        <div class="relative">
                            <input type="checkbox" id="private-toggle" class="sr-only" checked>
                            <label for="private-toggle" class="flex items-center cursor-pointer">
                                <div class="relative">
                                    <div class="w-12 h-6 bg-gray-300 rounded-full shadow-inner transition-colors duration-300"></div>
                                    <div class="absolute inset-y-0 left-0 w-6 h-6 bg-white rounded-full shadow transform transition-transform duration-300 translate-x-6 gradient-teal"></div>
                                </div>
                            </label>
                        </div>
                    </div>
                </div>
            </div>

        </div>

        <!-- Bottom Actions -->
        <div class="fixed bottom-0 left-1/2 transform -translate-x-1/2 w-full max-w-sm z-40">
            <div class="glass-morphism mx-4 mb-4 rounded-3xl shadow-craft-xl border border-white/30 p-4">
                <div class="flex gap-3">
                    <button id="preview-btn" class="flex-1 glass-card text-craft-black py-4 rounded-2xl text-sm font-medium hover:bg-gray-50 transition-colors flex items-center justify-center space-x-2">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path>
                        </svg>
                        <span>プレビュー</span>
                    </button>
                    <button id="save-btn-bottom" class="flex-1 gradient-teal text-white py-4 rounded-2xl text-sm font-medium shadow-teal-glow hover:scale-105 transition-all duration-300 flex items-center justify-center space-x-2">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                        </svg>
                        <span>保存して終了</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Save Success Modal -->
    <div id="save-success-modal" class="fixed inset-0 bg-black/50 modal-backdrop z-50 hidden flex items-center justify-center p-4">
        <div class="glass-card rounded-3xl shadow-craft-xl w-full max-w-xs p-8 text-center animate-scale-in">
            <div class="w-16 h-16 gradient-teal rounded-full flex items-center justify-center mx-auto mb-4">
                <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                </svg>
            </div>
            <h3 class="text-lg font-bold text-craft-black mb-2">保存完了！</h3>
            <p class="text-sm text-gray-500 mb-6">プロンプトが正常に保存されました</p>
            <button id="close-success-modal" class="gradient-teal text-white px-6 py-3 rounded-xl text-sm font-medium shadow-teal-glow hover:scale-105 transition-transform duration-200">
                OK
            </button>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            initializePromptEditor();
        });

        function initializePromptEditor() {
            // Elements
            const titleInput = document.getElementById('title-input');
            const contentTextarea = document.getElementById('content-textarea');
            const wordCount = document.getElementById('word-count');
            const progressText = document.getElementById('progress-text');
            const progressCircle = document.getElementById('progress-circle');
            const saveBtn = document.getElementById('save-btn');
            const saveBtnBottom = document.getElementById('save-btn-bottom');
            const previewBtn = document.getElementById('preview-btn');
            const newTagInput = document.getElementById('new-tag-input');
            const addTagBtn = document.getElementById('add-tag-btn');
            const successModal = document.getElementById('save-success-modal');
            const closeSuccessModal = document.getElementById('close-success-modal');
            const backBtn = document.getElementById('back-btn');

            // Back button navigation
            backBtn.addEventListener('click', function() {
                // Add loading animation
                const icon = this.querySelector('svg');
                const originalIcon = icon.innerHTML;
                icon.innerHTML = '<circle cx="12" cy="12" r="10" stroke-width="2" stroke="currentColor" fill="none" class="animate-spin"></circle>';
                
                // Navigate back to home page after short delay
                setTimeout(() => {
                    window.location.href = 'home-premium-jp.html';
                }, 300);
            });

            // Auto-resize textarea
            function autoResize(textarea) {
                textarea.style.height = 'auto';
                textarea.style.height = Math.max(200, textarea.scrollHeight) + 'px';
            }

            // Update word count and progress
            function updateWordCount() {
                const content = contentTextarea.value;
                const words = content.trim().split(/\s+/).filter(word => word.length > 0).length;
                const maxWords = 2000;
                const percentage = Math.min((words / maxWords) * 100, 100);
                
                wordCount.textContent = `${words} / ${maxWords}`;
                progressText.textContent = `${Math.round(percentage)}%`;
                
                // Update progress circle
                const circumference = 251.2;
                const offset = circumference - (percentage / 100) * circumference;
                progressCircle.style.strokeDashoffset = offset;
                
                // Update colors based on usage
                wordCount.className = 'text-sm font-medium';
                if (percentage > 90) {
                    wordCount.classList.add('text-red-500');
                } else if (percentage > 75) {
                    wordCount.classList.add('text-orange-500');
                } else {
                    wordCount.classList.add('text-gray-500');
                }
            }

            // Initialize word count
            updateWordCount();

            // Event listeners
            contentTextarea.addEventListener('input', function() {
                autoResize(this);
                updateWordCount();
            });

            // Initial auto-resize
            autoResize(contentTextarea);

            // Tag functionality
            const tagButtons = document.querySelectorAll('.tag-button');
            tagButtons.forEach(button => {
                button.addEventListener('click', function() {
                    this.classList.toggle('selected');
                });
            });

            // Add new tag
            function addNewTag(tagText) {
                if (tagText.trim()) {
                    const tagContainer = document.querySelector('.flex.flex-wrap.gap-2.mb-4');
                    const newTag = document.createElement('button');
                    newTag.className = 'tag-button selected px-3 py-2 rounded-xl text-sm font-medium';
                    newTag.textContent = tagText.trim();
                    newTag.addEventListener('click', function() {
                        this.classList.toggle('selected');
                    });
                    tagContainer.appendChild(newTag);
                    newTagInput.value = '';
                }
            }

            addTagBtn.addEventListener('click', () => {
                addNewTag(newTagInput.value);
            });

            newTagInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    addNewTag(newTagInput.value);
                }
            });

            // Toggle switches
            const toggles = document.querySelectorAll('input[type="checkbox"]');
            toggles.forEach(toggle => {
                toggle.addEventListener('change', function() {
                    const slider = this.nextElementSibling.querySelector('div:last-child');
                    const track = this.nextElementSibling.querySelector('div:first-child');
                    
                    if (this.checked) {
                        slider.classList.add('translate-x-6', 'gradient-teal');
                        track.classList.add('bg-craft-teal/30');
                        track.classList.remove('bg-gray-300');
                    } else {
                        slider.classList.remove('translate-x-6', 'gradient-teal');
                        track.classList.remove('bg-craft-teal/30');
                        track.classList.add('bg-gray-300');
                    }
                });
            });

            // Save functionality
            function savePrompt() {
                const saveButtons = [saveBtn, saveBtnBottom];
                
                saveButtons.forEach(btn => {
                    const originalText = btn.innerHTML;
                    btn.innerHTML = '<svg class="w-4 h-4 animate-spin mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" stroke-width="2"></circle></svg>';
                    btn.disabled = true;
                });

                setTimeout(() => {
                    // Show success modal
                    successModal.classList.remove('hidden');
                    document.body.style.overflow = 'hidden';
                    
                    // Reset buttons
                    saveButtons.forEach((btn, index) => {
                        if (index === 0) {
                            btn.innerHTML = '保存';
                        } else {
                            btn.innerHTML = '<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg><span>保存して終了</span>';
                        }
                        btn.disabled = false;
                    });
                }, 1000);
            }

            saveBtn.addEventListener('click', savePrompt);
            saveBtnBottom.addEventListener('click', savePrompt);

            // Close success modal
            closeSuccessModal.addEventListener('click', () => {
                successModal.classList.add('hidden');
                document.body.style.overflow = 'auto';
            });

            // Preview functionality
            previewBtn.addEventListener('click', function() {
                this.innerHTML = '<svg class="w-4 h-4 animate-spin" fill="none" stroke="currentColor" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" stroke-width="2"></circle></svg><span>読み込み中...</span>';
                
                setTimeout(() => {
                    this.innerHTML = '<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path></svg><span>プレビュー</span>';
                    // Here you would typically show a preview modal or navigate to preview page
                }, 800);
            });

            // Form validation
            const form = document.querySelector('form') || document.createElement('form');
            titleInput.addEventListener('input', function() {
                if (this.value.trim()) {
                    this.classList.remove('border-red-300');
                    this.classList.add('border-craft-teal');
                }
            });

            contentTextarea.addEventListener('input', function() {
                if (this.value.trim()) {
                    this.parentElement.classList.remove('border-red-300');
                    this.parentElement.classList.add('border-craft-teal');
                }
            });

            // Enhanced animations on scroll
            const animatedElements = document.querySelectorAll('.animate-fade-in');
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.style.opacity = '1';
                        entry.target.style.transform = 'translateY(0)';
                    }
                });
            }, { threshold: 0.1 });

            animatedElements.forEach(el => {
                el.style.opacity = '0';
                el.style.transform = 'translateY(20px)';
                el.style.transition = 'all 0.6s ease-out';
                observer.observe(el);
            });
        }
    </script>
</body>
</html>